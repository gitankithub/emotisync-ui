<div class="dialog-container">
  <!-- Close Icon -->
  <button class="close-icon" mat-icon-button (click)="close()">
    <mat-icon>close</mat-icon>
  </button>

  <!-- Full-width Image -->
  <div class="image-wrapper">
    <img [src]="data.imageUrl" alt="{{ data.hotelName }}" class="dialog-image" />
  </div>


  <!-- Content -->
  <div class="dialog-content">
    <h2>{{ data.hotelName }}</h2>
    <p class="details">{{ data.checkIn | date: 'd MMMM y' }} â€“ {{ data.checkOut | date: 'd MMMM y' }}</p>
    <p class="details">{{ data.roomType }} â€¢ {{ data.bedrooms }} bedroom(s) â€¢ {{ data.guests }} guest(s)</p>
    <p class="details">Status: {{ data.status | titlecase }}</p>

    <!-- Rating & Feedback -->
    <div class="rating-section" *ngIf="data.status === 'completed' || data.status === 'checkedin'">
      <h3>
        {{ data.status === 'completed'
        ? 'We Value Your Feedback!'
        : 'Weâ€™d love your thoughts on your stay so far!' }}
      </h3>

      <div class="emoji-bar">
        <button *ngFor="let r of ratings" (click)="setRating(r.value)" [class.active]="r.value === selectedRating"
          [attr.aria-label]="r.label">
          {{ r.emoji }}
        </button>
      </div>

      <mat-form-field appearance="outline" class="feedback-field" *ngIf="data.status === 'completed'">
        <mat-label>Feedback</mat-label>
        <textarea matInput [(ngModel)]="feedbackText" placeholder="Please share your experience..."></textarea>
      </mat-form-field>
    </div>

    <!-- Feedback Response -->
    <p *ngIf="selectedRating >= 4 && data.status !== 'completed'">Thank you for your feedback! ğŸ™</p>
    <p *ngIf="(selectedRating ?? 0) < 4 && (selectedRating ?? 0) > 0 && data.status !== 'completed'">
      Weâ€™re sorry for any inconvenience. Our team will assist you shortly.
      Please click help for further assistance.
    </p>
    &nbsp;

    <!-- Actions -->
    <div class="actions">
      <button *ngIf="data.status === 'completed' || data.status === 'checkedin'" mat-flat-button class="action-btn"
        (click)="submitFeedback()" [disabled]="!selectedRating && !feedbackText">
        Submit
      </button>

      <button *ngIf="data.status === 'upcoming' || data.status === 'checkedin'" mat-flat-button class="action-btn"
        (click)="redirectToHelp()">
        <mat-icon>chat</mat-icon>
        Help?
      </button>
    </div>
  </div>
</div>